<nav>
    <div style="display:flex; gap:10px;">
        <div class="widget"><span id="clock">00:00</span></div>
        <div class="widget" onclick="refreshWeather()">
            <span id="temp">SYNCING...</span>
            <span class="material-symbols-rounded" id="w-icon">sync</span>
        </div>
    </div>
    <div class="widget" onclick="toggleSettings()"><span class="material-symbols-rounded">settings</span> Settings</div>
</nav>

<script>
async function refreshWeather() {
    const icon = document.getElementById('w-icon');
    const temp = document.getElementById('temp');
    
    // 1. Change icon to arrows (sync) and start spinning
    icon.textContent = "sync"; 
    icon.classList.add('rotating'); 
    temp.textContent = "SYNCING...";

    try {
        const res = await fetch(`https://wttr.in/?format=j1&t=${Date.now()}`);
        const data = await res.json();
        temp.textContent = data.current_condition[0].temp_F + "Â°F";
        
        // 2. Once finished, stop spinning and change back to a cloud
        setTimeout(() => {
            icon.classList.remove('rotating');
            icon.textContent = "cloud"; // Only changes to cloud AFTER spinning
        }, 1000);

    } catch (e) {
        temp.textContent = "SERVICE ERR";
        icon.classList.remove('rotating');
        icon.textContent = "cloud_off";
    }
}
</script>
