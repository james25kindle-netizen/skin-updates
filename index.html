<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Velvet Void OS - 3D Preview</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.160.0/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/loaders/GLTFLoader.js"></script>
    
    <style>
        :root {
            --primary: #FFB4AB;
            --surface: #1A1110;
            --panel: #251918;
            --text: #EDE0DF;
            --radius-xl: 28px;
        }

        body {
            background-color: var(--surface);
            color: var(--text);
            font-family: 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        /* Main Glass Panel */
        .unified-panel {
            background: var(--panel);
            width: 400px;
            padding: 30px;
            border-radius: var(--radius-xl);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.05);
        }

        /* 3D Canvas Area */
        #canvas-container {
            width: 100%;
            height: 350px;
            background: radial-gradient(circle, rgba(255,180,171,0.08) 0%, rgba(0,0,0,0) 70%);
            border-radius: 20px;
            position: relative;
            cursor: grab;
            margin: 20px 0;
        }
        #canvas-container:active { cursor: grabbing; }

        /* Comparison Slider UI */
        .comparison-wrapper {
            display: none; /* Toggled via JS */
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        .comp-img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 12px;
            border: 1px solid rgba(255,180,171,0.2);
            background: #000;
        }
        .comp-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.5;
            display: block;
            margin-bottom: 5px;
        }

        .badge {
            background: rgba(255,180,171,0.1);
            color: var(--primary);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .toggle-btn {
            background: none;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 5px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
        }
        .toggle-btn:hover { background: var(--primary); color: var(--panel); }
    </style>
</head>
<body>

<div class="unified-panel">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <span class="badge">V3.1.0</span>
        <button class="toggle-btn" onclick="toggleView()" id="view-toggle">VIEW CHANGES</button>
    </div>

    <div id="canvas-container"></div>

    <div id="comp-view" class="comparison-wrapper">
        <div>
            <span class="comp-label">Before</span>
            <img src="old-skin.jpg" class="comp-img" alt="Old Version">
        </div>
        <div>
            <span class="comp-label">After</span>
            <img src="new-skin.jpg" class="comp-img" alt="New Version">
        </div>
    </div>

    <h2 style="margin: 10px 0 5px 0;">VELVET VOID</h2>
    <p id="status-text" style="opacity: 0.6; font-size: 0.9rem; margin-bottom: 0;">
        Interactive 3D Preview Active. Drag to rotate.
    </p>
</div>

<script>
    let scene, camera, renderer, model;
    let isDragging = false;
    let previousMouseX = 0;

    // 1. Setup the 3D Environment
    function init() {
        const container = document.getElementById('canvas-container');
        scene = new THREE.Scene();
        
        camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 1000);
        camera.position.z = 8;
        camera.position.y = 2;

        renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(container.clientWidth, container.clientHeight);
        container.appendChild(renderer.domElement);

        // Lights
        scene.add(new THREE.AmbientLight(0xffffff, 1.5));
        const light = new THREE.DirectionalLight(0xffffff, 1);
        light.position.set(5, 5, 5);
        scene.add(light);

        // 2. Load the model.gltf you provided
        const loader = new THREE.GLTFLoader();
        loader.load('model.gltf', (gltf) => {
            model = gltf.scene;
            // Center model based on the nodes (Head, Body, etc.) 
            const box = new THREE.Box3().setFromObject(model);
            const center = box.getCenter(new THREE.Vector3());
            model.position.y = -center.y; 
            scene.add(model);
        });

        animate();
    }

    // 3. Idle Animation (Look around)
    function animate() {
        requestAnimationFrame(animate);
        if (model && !isDragging) {
            const time = Date.now() * 0.001;
            // Subtle sway and look around
            model.rotation.y = Math.sin(time * 0.5) * 0.2;
            model.position.y = (Math.sin(time * 0.5) * 0.1) - 0.5;
        }
        renderer.render(scene, camera);
    }

    // 4. Mouse Rotation Controls
    window.addEventListener('mousedown', () => isDragging = true);
    window.addEventListener('mouseup', () => isDragging = false);
    window.addEventListener('mousemove', (e) => {
        if (isDragging && model) {
            const deltaX = e.clientX - previousMouseX;
            model.rotation.y += deltaX * 0.01;
        }
        previousMouseX = e.clientX;
    });

    // 5. Toggle between 3D and Photos
    function toggleView() {
        const comp = document.getElementById('comp-view');
        const canvas = document.getElementById('canvas-container');
        const btn = document.getElementById('view-toggle');
        const status = document.getElementById('status-text');

        if (comp.style.display === 'grid') {
            comp.style.display = 'none';
            canvas.style.display = 'block';
            btn.innerText = "VIEW CHANGES";
            status.innerText = "Interactive 3D Preview Active. Drag to rotate.";
        } else {
            comp.style.display = 'grid';
            canvas.style.display = 'none';
            btn.innerText = "VIEW 3D SKIN";
            status.innerText = "Comparison view of changes.";
        }
    }

    init();
</script>

</body>
</html>
